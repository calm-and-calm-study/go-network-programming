
### 간단하고 신뢰성 없는 UDP

- UDP 는 TCP 가 신뢰성 있도록 만드는 많은 기능들을 가지고 있지 않다.
- 소켓주소(IP 주소와 포트번호), [RFC 768](https://www.rfc-editor.org/rfc/rfc768.html) 에서 내용을 확인할 수 있다.
- 프로토콜 목적 자체가 애플리케이션이 최소한의 프로토콜 메커니즘으로 다른 프로그램으로 메시지를 보내기 위한 목적이다.

Format
------


                  0      7 8     15 16    23 24    31
                 +--------+--------+--------+--------+
                 |     Source      |   Destination   |
                 |      Port       |      Port       |
                 +--------+--------+--------+--------+
                 |                 |                 |
                 |     Length      |    Checksum     |
                 +--------+--------+--------+--------+
                 |
                 |          data octets ...
                 +---------------- ...

                      User Datagram Header Format Fields

- Source Port (소스 포트) [0 ~ 15]
  - 송신자의 포트 번호를 의미
  - 16비트 크기 -> 포트 번호 범위 : 0 ~ 65535
  - 클라이언트가 서버에 요청을 보낼 때 주로 동적 포트 (1024 ~ 65535)를 사용합니다.


- Destination Port (목적지 포트) [16 ~ 31]
  - 수신자의 포트 번호를 의미
  - 16비트 크기 -> 포트 번호 범위 : 0 ~ 65535
  - UDP 고정 포트
    - DNS (도메인 네임 시스템) UDP 포트 53
    - DHCP (동적 호스트 구성 프로토콜) UDP 포트 67, 68
    - SNMP (간단한 네트워크 관리 프로토콜) UDP 포트 161


- Length (길이) [32 ~ 47]
  - UDP 헤더 (8바이트) + 데이터 (payload) 의 총 길이를 나타냄
  - 16비트 크기 -> 최소 8바이트 ~ 최대 65535 바이트
  - 일반적으로 IP 패킷 크기 제한 (IPv4 의 경우 65535 바이트) 내에서 조정


- Checksum (체크섬) [48 ~ 63]
  - 데이터의 무결성 검증을 위한 값
  - 송신자가 UDP 헤더와 데이터 값을 기반으로 계산하여 설정, 수신자가 이를 비교하여 데이터가 손상되었는지 확인
  - IPv4 에서는 체크섬이 선택사항, IPv6 에서는 필수

- Data (데이터 페이로드) [64 ~]
  - 실제 전송하고자 하는 데이터가 들어가는 부분
  - 길이는 Length 필드 값 - 헤더 크기 값 (8바이트)


  
<br />

### UDP 가 하지 않는 것

- UDP 는 세션의 지원이 없다.
- UDP 는 목적지에 접근할 수 있는지 확인도 하지 않는다.
- 수신자는 자동으로 UDP 패킷에 대한 확인 패킷을 보내지 않는다.
- UDP 는 혼잡 상태를 관리하지 않는다.
- UDP 는 데이터의 흐름을 제어하지 않는다.
- UDP 는 패킷을 재전송하지 않는다.
- UDP 에는 수신자가 받은 패킷의 순서가 송신자가 보낸 순서와 같다는 보장이 없다.


<br />

### UDP 의 장점

- UDP 는 멀티캐스팅이라는 절차를 통해 하나의 패킷을 복제하지 않고 여러 노드로 전송할 수 있다.
- UDP 는 세션을 수립하지 않아도 서브넷 내의 모든 노드에게 패킷을 브로드캐스팅할 수 있다.



---

## 파편화 피하기

- 파편화란 네트워크 상에서 효율적인 전송을 위해 패킷을 작게 조각내서 전송하는 3계층 인터넷 프로토콜의 절차
- 모든 네트워크에는 MTU (Maximum Transmission Unit) 인 최대전송단위가 존재하여 패킷의 크기를 제한함
- 미디어의 MTU 이상의 패킷을 수신하게 되면 파편화가 필요함
- 조각난 패킷 파편들은 전송될 노드 간 미디어의 MTU 보다 작아야함
- 그러나 UDP 에서는 변질되거나 목적지에 도달하지 못한 패킷을 복구할 수 있는 기능이 없음
- 따라서 단 하나의 패킷의 파편을 받지 못하면 송신자는 모든 UDP 패킷을 전부 보내야 함

```shell
ping -M do -s 1500 1.1.1.1
```

- ICMP 패킷을 통해 네트워크 연결 상태를 테스트하는 명령어
- -M 은 MTU Path 테스트하는데 사용하는 옵션
- do : 패킷을 분할하지 않도록 설정
- -s 1500 : 전송할 패킷의 크기를 설정
- 1.1.1.1 : 테스트할 목표 IP 주소

실행 문구

```shell
PING 1.1.1.1 (1.1.1.1) 1500(1528) bytes of data.                                                                        
ping: local error: message too long, mtu=1500 
```
